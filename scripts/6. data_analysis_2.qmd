---
title: "Questioning the influence of roots: A soil fauna perspective on rhizosphere space"
format:
  html:
    css: css/styles.css  
    embed-resources: true
    code-tools: true
    
execute: 
  warning: false
  message: false
  echo: false
---

## Executive Summary

This study investigates the spatial behavior of soil fauna in relation to root systems, challenging the notion of the rhizosphere as a simple, static attraction zone. By integrating null model simulations with Generalized Additive Models (GAMs), we decouple biological selection from physical habitat constraints and reveal that the demographic benefits of rhizosphere exploitation are governed by a distinct temporal lag.

## Setup and data preparation

```{r}
# libraries
library(tidyverse)
library(mgcv)
library(broom)
library(gratia)
library(lubridate)
library(broom)
library(marginaleffects)
library(kableExtra)
library(DHARMa)
library(piecewiseSEM)
library(lme4)

# Global settings
set.seed(123)
if (!dir.exists("../output")) dir.create("../output")

# Ring surface function for density normalization
ring_surface <- function(r, width) {
  pi * ((r + width)^2 - r^2)}
# function to extract models results safely
safe_augment <- function(model, data, prefix) {
  df_new <- augment(model) %>%
    select(starts_with(".")) %>%
    rename_with(~ paste0(prefix, .))
  
  bind_cols(data, df_new)
}
```

```{r}
#| label: data-import
# Data Import & Alignment
habitat_data_raw <- read.csv("../output/distance_data_cleaned.csv") %>%
  mutate(date = parse_date_time(date, orders = c("Y-m-d H:M:S", "Y-m-d"), tz = "UTC"))

target_dates <- tibble(
  period = 1:7, 
  start_date = as.Date(c("2024-03-20", "2024-05-25", "2024-07-15", "2024-09-19", 
                         "2024-12-10", "2025-02-15", "2025-04-20"))
)

habitat_data_long <- habitat_data_raw %>%
  crossing(target_dates) %>%                
  filter(date >= start_date) %>%            
  group_by(date) %>%                         
  slice_max(start_date, n = 1) %>%           
  ungroup() %>%
  mutate(across(c(scanner, depth, period, position,orientation, Predicted.class.levelup, image_name), as.factor)) %>%
  select(scanner, image_name, temp, temp_soil_amplitude, hum, hum_soil_amplitude, invertebrate_count, predators_count, period, depth, position, orientation, Predicted.class.levelup, root_cm2_count,root_growth_cm2_count_24h,
         growth_obs = distance_root_growth_obs, 
         growth_exp = distance_root_growth_mean_exp, 
         growth_sd = distance_root_growth_sd_exp,
         mature_obs = distance_root_mature_obs, 
         mature_exp = distance_root_mature_mean_exp, 
         mature_sd = distance_root_mature_sd_exp) %>%
  pivot_longer(cols = starts_with(c("growth", "mature")), 
               names_to = c("root_type", ".value"), names_sep = "_") %>%
  mutate(z_score = (obs - exp) / sd) %>% 
  # filtering of extreme root density values
  filter(root_cm2_count >= quantile(root_cm2_count, 0.25, na.rm = TRUE) - 1.5 * IQR(root_cm2_count, na.rm = TRUE),root_cm2_count <= quantile(root_cm2_count, 0.25, na.rm = TRUE) + 1.5 * IQR(root_cm2_count, na.rm = TRUE)) %>%
  drop_na()
```

## 1. The rhizosphere effect: attraction and spatial signature

### *Do soil fauna actively select the rhizosphere space ?*

We employ a null model approach to determine whether soil fauna actively select the rhizosphere or if their proximity is a result of random distribution. By comparing observed animal-to-root distances against simulated expected distances, we calculate a standardized Z-score ($Z = \frac{obs - exp}{sd}$).

-   Active selection (attraction): Indicated by negative Z-scores.

-   Active avoidance (aepulsion): Indicated by positive Z-scores.

-   Statistical Validation: A Wilcoxon Test was used to determine if median Z-scores significantly deviated from zero.

```{r}
#| label: global-attraction-plot
# Statistical summary of Z-scores by Taxa and Root Type
rhizo_results <- habitat_data_long %>%
  group_by(Predicted.class.levelup, root_type) %>%
  summarise(
    n = n(),
    med_z = median(z_score, na.rm = TRUE), # Median of the normalized score
    p_val = wilcox.test(z_score, mu = 0)$p.value, # Test if Z is sig. different from 0
    .groups = "drop") %>%
  mutate(
    p_label = case_when(p_val < 0.001 ~ "***", p_val < 0.01 ~ "**", p_val < 0.05 ~ "*", TRUE ~ "ns"))

# Define background zones for visualization
bg_zones <- tibble(xmin = c(0, -Inf),xmax = c(Inf, 0),ymin = -Inf, ymax = Inf, zone = c("Avoidance","Selection"))

# Visualization of the Attraction Index
p1 <- habitat_data_long %>%
  filter(z_score >= quantile(z_score, 0.25, na.rm = TRUE) - 1.5 * IQR(z_score, na.rm = TRUE),
    z_score <= quantile(z_score, 0.25, na.rm = TRUE) + 1.5 * IQR(z_score, na.rm = TRUE)) %>%
  ggplot(aes(x = z_score, y = Predicted.class.levelup)) +
  geom_rect(data = bg_zones, aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax, fill = zone), inherit.aes = FALSE, alpha = 0.15) +
  geom_jitter(alpha = 0.1, height = 0.1, color = "grey60") +
  geom_segment(data = rhizo_results, aes(y = Predicted.class.levelup, yend = Predicted.class.levelup, x = 0, xend = med_z),arrow = arrow(length = unit(0.20, "cm")), linewidth = 1.2, color = "#e50000") +
  geom_vline(xintercept = 0, color = "black", linetype = "dashed", linewidth = 1.2) +
  geom_text(data = rhizo_results, aes(x = med_z, y = Predicted.class.levelup, label = p_label), 
            vjust = -0.5, color = "black", size = 5, fontface = "bold") +
  facet_grid(root_type ~ .) +
  scale_fill_manual(values = c("Selection" = "#F1F4C6", "Avoidance" = "#AAA6A4"), guide = "none") +
  labs(x = "Standardized Attraction Index (Z-score)", 
       y = NULL, 
       title = "Rhizosphere Attraction Index",
       subtitle = "Negative Z-scores indicate active selection of the root zone") +
  theme_minimal() +
  theme(panel.border = element_rect(color = "black", fill = NA, linewidth = 1.5),
        strip.text = element_text(size = 13, face = "bold"),
        axis.title.x = element_text(size = 12),
        title = element_text(size = 15, face = "bold"))


p1
tiff("../output/1.zscore_distribution.tiff", width = 1800, height = 1700, res = 600)
p1
dev.off()
```

The analysis reveals significant, taxa-specific attraction to the root surface, particularly for Collembola and Gastropoda. The strength of this selection varies by root type, suggesting that biological drivers—such as root exudation—shape spatial clustering beyond what is expected by chance.

### *Defining the rhizosphere width*

To identify the precise spatial extent of root influence, we model animal density as a function of distance using GAMs. We incorporate a geometric correction (log-area offset) to account for the increasing soil volume available at greater distances from the root. The root influence zone tipping point is defined as the distance where the first derivative of the model plateau, indicating that the root's influence on animal density has vanished.

```{r}
#| label: riz-extraction
### 1. Data Binning and Geometric Area Correction 
max_dist <- 10
bin_w <- 0.1 #cm

# Calculate the number of animals per distance bin and the available area.
rhizo_decay_data <- habitat_data_long %>%
  # Filter out distances that are too large and biased by edge effects
  filter(obs <= max_dist) %>%
  # Create bins and assign observations to the midpoint of the bin
  mutate(dist_bin = floor(obs / bin_w) * bin_w + bin_w/2) %>%
  group_by(dist_bin, Predicted.class.levelup, root_type) %>%
  summarise(n_animals = n(), .groups = "drop") %>%
  # GEOMETRIC CORRECTION: Calculate the area of the concentric ring (annulus).
  # As distance (r) increases, the sampled area increases proportionally.
  # Area = pi * (R_outer^2 - R_inner^2)
  mutate(area = pi * ((dist_bin + bin_w/2)^2 - (dist_bin - bin_w/2)^2))

### 2. GAM Fitting and Derivative Analysis
extract_gam_stats <- function(df) {
  # Minimum data threshold to ensure model stability
  if (n_distinct(df$dist_bin) < 5 || sum(df$n_animals) < 10) return(NULL)
  
  # MODEL: Generalized Additive Model (GAM)
  # Family = quasipoisson
  # Offset = log(area): Treats the sampled area as an 'exposure' variable. 
  # This converts the raw count model into a density model (count/area) 
  # without the statistical pitfalls of using ratios directly.
  model <- tryCatch({
    gam(n_animals ~ s(dist_bin, k = 5), 
        offset = log(area), 
        data = df, 
        family = nb())
  }, error = function(e) return(NULL))
  
  if (is.null(model)) return(NULL)
  
  # RHIZOSPHERE IDENTIFICATION 
  # We use the first derivative (slope) of the model to find where 
  # the influence of the root stops (the plateau).
  eval_pts <- data.frame(dist_bin = seq(0.05, 10, length.out = 200))
  derivs <- derivatives(model, data = eval_pts, type = "forward")
  
  # STATISTICAL TIPPING POINT:
  # The RIZ is defined as the distance where the 95% Confidence Interval 
  # of the derivative first includes zero. At this point, the density 
  # slope is no longer significantly different from a horizontal line.
  riz_val <- derivs %>%
    mutate(lower = .derivative - 1.96 * .se,
           upper = .derivative + 1.96 * .se) %>%
    # Filter out the first 0.5cm to avoid noise near the root surface
    filter(dist_bin > 0.5, (lower < 0 & upper > 0) | lower > 0) %>% 
    slice(1) %>% 
    pull(dist_bin)
  
  #MODEL VALIDATION TESTS
  res <- simulateResiduals(model, n = 250, plot = FALSE)
  test_ks <- testUniformity(res, plot = FALSE)$p.value             # Distribution test
  test_disp <- testDispersion(res, plot = FALSE)$p.value # Surdispersion test
  test_out <- testOutliers(res, plot = FALSE)$p.value   # Outliers tests
  
  # RESULTS SUMMARY 
  tibble(
    edf = summary(model)$edf,             # Complexity of the curve (1 = linear)
    p_val = summary(model)$s.pv,          # Significance of the spatial pattern
    dev_expl = summary(model)$dev.expl * 100, # % of variance explained by root distance
    riz_cm = if(length(riz_val) > 0) riz_val else NA_real_, # Distance of influence
    n_total = sum(df$n_animals),           # Total count for the group
    check_ks = test_ks,     # If < 0.05, distribution shape problem
    check_disp = test_disp, # If < 0.05, overdispersion (justifies the quasi-Poisson distribution)
    check_out = test_out   # If < 0.05, too many outliers
  )
}

rhizo_stats_table <- rhizo_decay_data %>%
  group_by(Predicted.class.levelup, root_type) %>%
  do(extract_gam_stats(.))

# 3. Tabular Presentation
n_rows <- nrow(rhizo_stats_table)
t1 <- rhizo_stats_table %>%
  select(-check_ks, -check_disp, -check_out)%>%
  rename(taxa = Predicted.class.levelup, `root Type` = root_type,
         `complexity (EDF)` = edf, `p-value` = p_val, `dev. Expl (%)` = dev_expl,
         `RIZ (cm)` = riz_cm, `n total` = n_total) %>%
  mutate(across(where(is.numeric), ~ round(.x, 3))) %>%
  kbl(caption = "Identification of the rhizosphere width through derivative analysis of animal density gradients",
      booktabs = TRUE, align = "c") %>%
  kable_styling(bootstrap_options = c("hover", "condensed"), full_width = F, position = "center") %>%
  row_spec(0:n_rows,extra_css = "border-bottom: 2px solid #dee2e6;") %>%
  row_spec(1:n_rows, background = "white") %>%
  row_spec(0, bold = TRUE, background = "#f2f2f2") %>%
  column_spec(4, color = spec_color(rhizo_stats_table$p_val, end = 0.1, direction = -1)) %>%
  column_spec(6, bold = T, border_left = "3px solid #b20000", border_right = "3px solid #b20000") %>%
  collapse_rows(columns = 1:3, valign = "top")

tiff("../output/2.rhizosphere_width.tiff", width = 1800, height = 1700, res = 600)
t1
dev.off()
```

## 2. The geometric niche: habitat availability constraint

### *Are fauna close to the root by choice (attraction) or necessity (habitat saturation) ?*

While attraction is a key driver, the physical presence of roots inherently constrains the available habitat. As root density increases, bulk soil volume diminishes, mathematically increasing the probability of fauna-root encounters regardless of biological preference. To isolate the true "biological signal," we modeled the deviation between observed and expected distances ($Obs - Exp$) across a root density gradient. We utilized a Generalized Additive Model (GAM) with a Student-t (scat) distribution to account for the heavy-tailed nature of ecological distance data.

```{r}
#| label: geometric-constraint-model
#| results: hide
#| fig-show: hide
# Modeling the gap (Obs - Exp) as a function of root density
mod_delta <- gam(
    (obs - exp) ~ Predicted.class.levelup + root_type +
    s(root_cm2_count,  by = interaction(root_type, Predicted.class.levelup,  drop = TRUE), k=5) + 
    s(period, bs = "re") + 
    s(scanner, bs = "re"),
  data = habitat_data_long, 
  family = scat(),
  method = "REML"
)

# Check model performances
#gam.check(mod_delta, rep = 1000)
plot(DHARMa::simulateResiduals(mod_delta))

# Extract significance for plot annotation
s_tab <- as.data.frame(summary(mod_delta)$s.table) %>%
  tibble::rownames_to_column("smooth") %>%
  filter(grepl("root_cm2_count", smooth)) %>%
  mutate(
    p_label = cut(`p-value`, 
                  breaks = c(-Inf, 0.001, 0.01, 0.05, Inf), 
                  labels = c("***", "**", "*", "ns")),
    group_str = gsub("s\\(root_cm2_count\\):interaction\\(root_type, Predicted.class.levelup, drop = TRUE\\)", "", smooth)
  ) %>%
  separate(group_str, into = c("root_type", "Predicted.class.levelup"), sep = "\\.")

# Augment data for plotting
habitat_delta <- safe_augment(mod_delta, habitat_data_long, "delta")
```

```{r}
#| label: geometric-constraint-plot
p2 <- ggplot(habitat_delta, aes(x = root_cm2_count, y = delta.fitted)) +
  geom_hline(yintercept = 0, 
             color = "black", size = 0.5, alpha = 0.3) +
  # The 95% Confidence Interval Envelope
  geom_ribbon(aes(ymin = delta.fitted - 1.96 * delta.se.fit, 
                  ymax = delta.fitted + 1.96 * delta.se.fit), 
              fill = "#002651", alpha = 0.1) +
  # The Original Fitted Points: Points are colored if they represent active attraction 
  geom_point(aes(color = delta.fitted), size = 1.5, alpha=0.4) +
  scale_color_gradient2(low = "#b20000", mid = "#FFD93D",high = "white",   midpoint = 0) +
  coord_cartesian(ylim = c(-2, 1))+
  # The Rug Plot (Shows data density on the X-axis)
  geom_rug(alpha = 0.2, color = "black", #sides = "b"
           ) +
  # Significance Annotations
  geom_text(data = s_tab, aes(x = Inf, y = -Inf, label = paste("Significance:", p_label)),hjust = 1.5, vjust = -3, inherit.aes = FALSE, size=3,fontface = "bold") +
  
  facet_grid(root_type ~ Predicted.class.levelup, scales = "free") +
  # Styling
  labs(
    title = "Biological selection vs. geometric constraint",
    subtitle = "Negative values represent active biological attraction beyond spatial probability",
     x = "Root density scaled", y = "Obs − Exp Fitted Distance (cm)",color = "Index") +
  theme_bw() +
  theme(panel.border = element_rect(color = "grey", fill = NA, linewidth = 0.1),
  panel.grid.minor = element_blank(),
  strip.background = element_rect(fill = "white", color = NA),
  strip.text = element_text(size = 12, face = "bold"),
  axis.title.x = element_text(size = 12),
  title = element_text(size=14))

p2
tiff("../output/2.geometric_constraint.tiff", width = 1800, height = 1700, res = 600)
p2
dev.off()
```

Growing Roots: Biological attraction remains relatively stable across the density gradient, suggesting that high-quality growth zones (e.g., exudates) provide a signal strong enough to overcome the geometric noise of increasing root surface area.

Mature Roots: These systems exhibit a "convergence" effect where biological deviation tends toward zero at high densities. This indicates that in dense mature networks, fauna proximity is increasingly governed by habitat availability constraints rather than active selection.

## 3. The selection - demography link : trait or by-product ?

### *Is root selection a mechanical consequence of high population density or a functional driver of invertebrate success ?*

We tested two competing hypotheses to explain the relationship between spatial behavior and population dynamics: a mechanistic approach, which tests whether demographic processes dictate spatial behavior, and a functional approach, which tests whether the ability to locate and exploit roots leads to population growth.

```{r}
#| label: data-prep
# Using sqrt transformation as it provided the best fit
data_growth <- habitat_delta %>%
  group_by(image_name, Predicted.class.levelup, root_type) %>%
  mutate(abundance = sqrt(n())) %>%
  ungroup() %>%
  group_by(scanner, period, Predicted.class.levelup, root_type) %>%
  mutate(lag1_delta_resid = lag(delta.resid, n = 1),
    lag2_delta_resid = lag(delta.resid, n = 2))%>%
  select(-delta.sigma)%>%
  drop_na()
```

#### **1. Mechanistic hypothesis: Do demographic processes dictate spatial behaviour?**

*"The intensity of root selection is a behavioural response constrained by population density (density dependence)."*

Model :

`gam(delta.resid ~ Predicted.class.levelup + root_type +  s(abundance, by = interaction(Predicted.class.levelup, root_type, drop=TRUE), k=10) + s(scanner, bs="re")+ s(period, bs="re"),family = gaussian(link = "identity"), method = "REML", select = TRUE, data = data_growth)`

```{r}
#| label: mecanistic-approach
mecanistic_model <- gam(delta.resid ~ Predicted.class.levelup + root_type + 
                          s(abundance, by = interaction(Predicted.class.levelup, root_type, drop=TRUE), k=10) + 
                        s(scanner, bs="re")+ s(period, bs="re"), 
                        family = gaussian(link = "identity"), 
                        method = "REML", 
                        select = TRUE,
                        data = data_growth)


#model performance
#gam.check(mecanistic_model, rep = 1000)
plot(DHARMa::simulateResiduals(mecanistic_model))

#model results
tidy(mecanistic_model) %>% 
  filter(p.value < 0.05) %>% 
  select(term, edf, p.value)
#data_growth <- safe_augment(mecanistic_model, data_growth, "mech") # not working with lag
#gratia::draw(mecanistic_model, parametric = FALSE) 
```

#### **2. Functional approach : Does an organism's ability to locate and exploit the root result in an increase in its population?**

*As an "oasis" of resources (exudates, associated microflora, moisture), the root is not just a place where they happen to be, but a driver of their population dynamics. If a taxon is able to effectively 'select' roots (for mucus, exudates or microhabitats), it gains access to more energy, which promotes its reproduction and therefore its overall abundance.*

Model :

`gam(abundance ~ Predicted.class.levelup + root_type + s(delta.resid, by = interaction(Predicted.class.levelup, root_type, drop = TRUE), k=10) + s(scanner, bs="re")+ s(period, bs="re"), Gamma(link = "log"), data = data_growth,method = "REML", select = TRUE)`

```{r}
#| label: functionnal approach
functionnal_model <- gam(abundance ~ Predicted.class.levelup + root_type + 
                          s(delta.resid, by = interaction(Predicted.class.levelup, root_type, drop = TRUE), k=10) 
                         + s(scanner, bs="re")+ s(period, bs="re"),
                         Gamma(link = "log"), 
                         data = data_growth,
                         method = "REML", 
                         select = TRUE)

#model performance
#gam.check(functionnal_model, rep = 1000)
plot(DHARMa::simulateResiduals(functionnal_model))

#model results
tidy(functionnal_model) %>% 
  filter(p.value < 0.05) %>% 
  select(term, edf, p.value)
#data_growth <- safe_augment(functionnal_model, data_growth, "func")
#gratia::draw(functionnal_model, parametric = FALSE) 
```

```{r}
summary_table <- bind_rows(
  glance(mecanistic_model) %>% mutate(model = "Mechanistic"),
  glance(functionnal_model) %>% mutate(model = "Functional")
) %>%
  select(model, adj.r.squared, deviance, AIC, BIC, df, nobs)

kable(summary_table, digits = 3, col.names = c("Model", "Adj. R²", "Deviance", "AIC", "BIC", "df", "N Obs."),
      caption = "Statistical comparison between Mechanistic and Functional models",
      booktabs = TRUE, align = "c") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
```

Demographic processes (population density) do not explain spatial selection patterns ($R^2 \approx 0.008$). Conversely, biological selection significantly influences demographic processes ($R^2 \approx 0.54$).

Surprisingly, our results initially appeared to contradict the "functional oasis" hypothesis. Instantaneous abundance was lower where selection was most intense, suggesting that the local carrying capacity is not influenced by the ability to exploit the rhizosphere, but rather the ability not to exploit it.

#### **Could there be a phase shift between the selection behaviour of growing roots and demographic success?**

We introduced temporal lags (Lag 1 and Lag 2) into our GAMs to determine if there is a phase shift between selection behavior and demographic success.

Model :

`gam (abundance ~ Predicted.class.levelup + root_type + s(lag1_delta_resid, by = interaction(Predicted.class.levelup, root_type, drop = TRUE), k=10) + s(lag2_delta_resid, by = interaction(Predicted.class.levelup, root_type, drop = TRUE), k=10) + s(delta.resid, by = interaction(Predicted.class.levelup, root_type, drop = TRUE), k=10) + s(scanner, bs="re")+ s(period, bs="re"), Gamma(link = "log"), data = data_growth, method = "REML", select = TRUE)`

```{r}
#| label: functionnal temporal approach
functionnal_lag_model <- gam(abundance ~ Predicted.class.levelup + root_type + 
                          s(lag1_delta_resid, by = interaction(Predicted.class.levelup, root_type, drop = TRUE), k=10) + 
                          s(lag2_delta_resid, by = interaction(Predicted.class.levelup, root_type, drop = TRUE), k=10) + 
                          s(delta.resid, by = interaction(Predicted.class.levelup, root_type, drop = TRUE), k=10) 
                         + s(scanner, bs="re")+ s(period, bs="re"),
                         Gamma(link = "log"), 
                         data = data_growth,
                         method = "REML", 
                         select = TRUE)

#model performance
#gam.check(functionnal_lag_model, rep = 1000)
plot(DHARMa::simulateResiduals(functionnal_lag_model))

#model results
#summary(functionnal_lag_model)
#gratia::draw(functionnal_lag_model, parametric = FALSE) 
tidy(functionnal_lag_model) %>% 
  filter(p.value < 0.05) %>% 
  select(term, edf, p.value)
# smooth estimates model extraction
sm <- smooth_estimates(functionnal_lag_model,n = 100,unconditional = TRUE,overall_uncertainty = TRUE)

plot_data <- sm %>%
  filter(str_detect(.smooth, "delta.resid")) %>%
  mutate(
    lag_type = case_when(
      str_detect(.smooth, "lag1") ~ "Lag 1",
      str_detect(.smooth, "lag2") ~ "Lag 2",
      TRUE ~ "Lag 0"
    ),
    # Use coalesce to create a single x variable
    x_val = coalesce(delta.resid, lag1_delta_resid, lag2_delta_resid)
  ) %>%
  # Split interaction term for faceting
  separate(
    `interaction(Predicted.class.levelup, root_type, drop = TRUE)`,
    into = c("class", "root"),
    sep = "\\."
  )

# Plot
plot_data%>%
mutate(lag_type = factor(lag_type, levels = c("Lag 2", "Lag 1", "Lag 0"))) %>%
ggplot(aes(x = x_val, y = .estimate, group = lag_type)) +
  geom_hline(yintercept = 0, linewidth = 0.5)+
  geom_ribbon(
    aes(
      ymin = .estimate - .se,
      ymax = .estimate + .se,
      fill = lag_type
    ),
    alpha = 0.15
  ) +
  geom_line(aes(color = lag_type), linewidth = 1.5) +
  facet_grid(root ~ class, scales = "free_y") +
  labs(
    title = "Comparison of selection effects across temporal lags",
    x = "Selection intensity (delta.resid)",
    y = "Partial effect on abundance (log scale)",
    color = "Lag",
    fill = "Lag"
  ) +
  scale_fill_manual(values = c("#FAB12F", "#FA812F", "#DD0303")) +
  scale_color_manual(values = c("#FAB12F", "#FA812F", "#DD0303")) +
  theme_bw() +
  theme(
    panel.border = element_rect(color = "grey", fill = NA, linewidth = 0.1),
    panel.grid.minor = element_blank(),
    strip.background = element_rect(fill = "white", color = NA),
    strip.text = element_text(size = 12, face = "bold"),
    axis.title.x = element_text(size = 12),
    legend.position = "bottom",
    plot.title = element_text(size = 12)
  )
```

By decoupling spatial behavior from population dynamics, we demonstrate that rhizosphere selection seems to be a functional trait, but its benefits are subject to a time lag. Maximum abundance does not coincide with immediate active selection, but rather with the memory of selection. This suggests a "legacy effect" where the energetic gains from foraging in high-quality root zones (e.g., during peak exudation) require a specific period to manifest as a measurable increase in population density through reproduction or recruitment ?
